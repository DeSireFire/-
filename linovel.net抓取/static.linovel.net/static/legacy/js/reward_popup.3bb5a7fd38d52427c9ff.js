(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{0:function(a,e){a.exports=jQuery},132:function(a,e,d){"use strict";var n=function(a){return a&&a.__esModule?a:{default:a}}(d(0));!function(){var a=(0,n.default)("#bookRewardButton"),e=(0,n.default)("#bookRewardRank"),d=(0,n.default)("#bookMonthTicket"),t=(0,n.default)("#rewardPopup"),i=(0,n.default)("#rewardRankPopup"),r=(0,n.default)("#monthTicketPopup"),s=r.find("input[type=submit]"),o=t.find("input[type=submit]"),l=(0,n.default)("#selfCreditTip"),u=(0,n.default)("#successHint"),c=(0,n.default)("#selfTicketTip"),f=(0,n.default)(".choose-numbers input[type=radio]");function h(){t.addClass("loading").modal("show"),n.default.get("/my/credit?uid="+rewardCfg.userId,function(a){if(0!=a.code)return alert(a.msg),void t.modal("hide");!function(a){var e=function a(e){var d,i=p()?e[2]:e[1],r=parseInt((0,n.default)('input[name="value"]:checked').val()),s='<a class="charge-btn" href="/pay" target="_blank">充值</a>';d=p()?'<br>墨水不足，墨水可通过 <a class="charge-btn" href="/my/credit" target="_blank">签到</a> 获得':window.onCharge?'<br>如果充值成功，请 <a class="charge-btn" href="javascript:;" target="_blank">刷新余额</a><br>或尝试重新 '+s:" 余额不足请 "+s,i<r?(l.addClass("danger"),o.addClass("disabled")):(d="",l.removeClass("danger"),o.removeClass("disabled"));var u=" <b>"+function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}(i)+"</b> ";l.html("<span class='unit'>"+g()+"</span>余额"+u+d),t.find(".charge-btn").unbind("click"),t.find(".charge-btn").click(function(){window.onCharge?h():(window.onCharge=!0,a(e))})},d=function(a){return function(){e(a)}}(a.lists);f.on("ifToggled",d),o.unbind("click").click(function(a){if(a.stopPropagation(),(0,n.default)(this).hasClass("disabled"))return!1;var e=parseInt((0,n.default)('input[name="value"]:checked').val()),d={uid:rewardCfg.userId,bid:rewardCfg.oid,unit:p()?2:1,value:e};n.default.post("/book/reward",d,function(a){if(window.onCharge=!1,0!=a.code)return alert(a.msg),-8==a.code&&(location.href=a.url),void t.modal("hide");(0,n.default)("#rewardSuccessPopup").modal("show");var e="";a.data.extraReward.length>0&&(e+=a.data.extraReward.join("<br>")+"<br>"),u.html(e+"累计应援可以上应援榜哦"),t.modal("hide")})}),t.removeClass("loading"),(0,n.default)(".reward-item").on("click",function(){e(a.lists)}),m(),e(a.lists)}(a.data,a.unit)})}function p(){return t.hasClass("side-b")}function g(){return p()?"墨水":"轻币"}function m(){t.find(".unit").html(g())}(0,n.default)(".reward-item.item-a").click(function(){t.removeClass("side-b"),m()}),(0,n.default)(".reward-item.item-b").click(function(){t.addClass("side-b"),m()}),a.click(h),e.click(function(){i.hasClass("loaded")?i.modal("show"):(i.addClass("loading").modal("show"),n.default.get("/book/rewardList?bid="+rewardCfg.oid+"&pageSize=99",function(a){if(0!=a.code)return alert(a.msg),void t.modal("hide");!function(a){var e,d,n;for(i.find(".reward-rank-list").empty(),d=0;d<a.length;d++)n=a[d],console.log(n),e='<li class="reward-rank-item no-'+(d+1)+'"><a class="reward-rank-link" href="/user/info?id='+n.id+'"><span class="rank-no">'+(d+1)+'</span><span class="rank-nick">'+n.nick+'</span><span class="rank-score">'+n.count+"援力</span></a></li>",i.find(".reward-rank-list").append(e);i.removeClass("loading").addClass("loaded")}(a.data.lists)}))}),d.click(function(){r.addClass("loading").modal("show"),n.default.get("/my/credit?uid="+rewardCfg.userId,function(a){if(0!=a.code)return alert(a.msg),void r.modal("hide");!function(a){s.click(function(a){if(a.stopPropagation(),(0,n.default)(this).hasClass("disabled"))return!1;var e={uid:rewardCfg.userId,bid:rewardCfg.oid,unit:3,value:1},d=this;(0,n.default)(d).addClass("disabled"),n.default.post("/book/reward",e,function(a){if((0,n.default)(d).removeClass("disabled"),0!=a.code)return alert(a.msg),-8==a.code&&(location.href=a.url),void r.modal("hide");u.html(""),(0,n.default)("#rewardSuccessPopup").modal("show"),r.modal("hide")})}),r.removeClass("loading").addClass("loaded"),function(a){var e=a[3];e<1?(c.addClass("danger"),s.addClass("disabled")):(c.removeClass("danger"),s.removeClass("disabled")),c.html("剩余月票 <b>"+e+"</b> "),r.find(".charge-btn").click(function(){h()})}(a.lists)}(a.data,a.unit)})})}()}},[[132,0]]]);